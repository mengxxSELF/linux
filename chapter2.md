# shell

![brain](https://user-gold-cdn.xitu.io/2018/12/19/167c486413b61934?w=718&h=365&f=png&s=21716)

## vim

vi是 Linux最常用的一个文本编辑器 一般使用的是vim 是vi的升级版本

特点

1 系统内置

2 很多软件的编辑接口 会调用vi

3 vim 可配置 可扩展 功能强大

vi 共分为三种模式，分别是『一般/命令模式』、『编辑模式』与『视图模式』

一般模式  以 vi 打开一个档案就直接进入一般模式了(这是默认的模式)

编辑模式：  一般模式当中, 按下任何一个字母（一般是i）之后会进入编辑模式

视图模式模式： 一般模式当中，输入『 : / ? i』三个中的任何一个按钮，就可以将光标移动到最底下那一行

### 一般模式

* vim 打开文件操作

普通打开文件 

```js
vim filename
```

打开文件，并将光标置于第n行首 

```js
vim +n filename
```

打开文件，并将光标置于最后一行首 

```js
vim + filename
```

打开文件，并将光标置于第一个与pattern匹配的串处 

```js
vim +/pattern  filename
```
* 光标位置移动

| 移动 | 快捷键 |
| ------------- | ------------- |
| 光标移至句首 句尾  | ( / ) |
| 光标移至段落 结尾 开头  | { / } |
| 光标移至当前行的  开头 结尾  | 0 / $ |
| nG  | 光标移至第n行首  |


## shell

操作系统是一组软件，用于控制硬件。如果这组软件能被用户随意操作会导致系统崩溃。所以不能让用户随意去使用。因此产生了一种在操作系统上的应用程序->shell

我们需要通过shell将输入的命令与内核进行通信，这样内核就可以控制硬件来工作

查看可用的shell

```js
/etc/shells 
```

使用者什么时候可以取得 shell 来工作呢？使用者默认会取得哪一个 shell ?
 —— 登陆的时候，系统就会给一个 shell 。 而这个登陆取得的 shell 就记录在 /etc/passwd 这个文件内

显示当前使用的shell

```js
echo $SHELL
```

## bash

bash 的特点

1 命令记忆功能

『上下键』可以追溯命令

~/.bash_history 记录的是前一次登陆以前所运行过的命令， 而至于这一次登陆所运行的命令都被缓存在内存中，当你成功的注销系统后，该命令记忆才会记录到 .bash_history 当中

2 命令与文件补全功能

tab 键

3 命名别名设置功能

```js
alias // 查询所有的设置别名
alias lm=‘ls -al’ // 进行别名设置
```

4 作业控制，前台，后台控制

5 程序脚本

当登录到Linux后，会依据/etc/passwd 文件的设置来给一个shell（默认bash） 然后就可以依据上面的命令操作 shell

### 命令

bash中命令分为两种

内部命令：由 bash 内置的命令

外部命令：来字外部的命令，非 bash 内置

查询一个命令是外部的还是bash内置的呢？ -- type

![type](https://user-gold-cdn.xitu.io/2018/12/19/167c491595e6c05e?w=833&h=312&f=png&s=313066)

* 命令的查找顺序

```js
type -a ls 
```

1．以相对/绝对路径来执行命令

2．由 alias 找到命令来执行

3．由 bash 内置命令来执行

4．通过$PATH 的顺序找到的第一个命令来执行

![type](https://user-gold-cdn.xitu.io/2018/12/19/167c49779c300795?w=892&h=343&f=png&s=343507)


### 变量

进入 shell 之前，系统需要一些变量来提供他数据的存取 (或者是一些环境的配置参数值， 例如是否要显示彩色等等的) ，所以就有一些所谓的『环境变量』 读入系统中了 比如常见的 PATH、HOME、MAIL、SHELL 等等

* 设置环境变量

读取  $  —-    echo $PATH    echo ${PATH}
设置  1 =   2  字母与数字，但开头不能为数字 3 两侧无空格 
删除   unset

| 变量的设置规则 |
| --- | --- | --- | --- |
| 变量名称只能是字母与数字，但开头不能为数字 |
| 双引号内的特殊字符可以保留原特性，比如$ 可正确读取字符串中的变量，单引号则不会 |

* export

变量分为：环境变量和自定义变量，两者的差异在于 是否可以被子进程使用
子进程会继承父级进程的环境变量，不会继承父进程的自定义变量

使用 export 可将变量调整为 全局变量
 
查看变量： env (环境变量)  set  (环境变量 + 自定义)

* 为什么进入bash就可以读取到变量

系统有一些环境配置文件的存在，让 bash 在启动时直接读取这些配置文件，可以理解为执行了一遍这些文件，因为使其配置生效

1 /etc/profile  系统最主要的shell配置文件，每次login，bash都要读取 /etc/profile文件

2 个人配置文件

bash 在读完了整体环境配置的 /etc/profile 以及其他配置文件后，接下来则是会读取使用者的个人配置文件

在 login shell 的 bash 环境中，所读取的个人偏好配置文件其实主要有三个，依序分别是：

1  ~/.bash_profile    2   ~/.bash_login     3  ~/.profile

其实 bash 的 login shell 配置只会读取三个文件的其中一个， 而读取的顺序则是依照上面的顺序。也就是说，如果 ~/.bash_profile 存在，那么其他两个文件不论有无存在，都不会被读取。 
如果 ~/.bash_profile 不存在才会去读取 ~/.bash_login，而前两者都不存在才会读取 ~/.profile 的意思

~/.bash_profile  是个人的bash配置文件，存在每位用户的$HOME

~/.bash_login  用户登陆时 bash会读取这个文件。通常把登陆就要执行的指令放在这

------------------

Q： 设置常用工作目录

A： 

1 查询当前使用的shell  

```js
echo $SHELL
```

现在的例子是在Mac演示的，我的Mac安装的 zsh

2 打开配置文件

```js
cat ~/.zshrc 
```

3 配置环境变量 设置常用的工作路径

```js
export SHOPTS=/home/work/xxx
```

修改配置文件之后   source 使其生效 否则需要重启


------------------






